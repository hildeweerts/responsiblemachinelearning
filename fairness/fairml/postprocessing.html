
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Post-processing Algorithms &#8212; An Introduction to Responsible Machine Learning</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Interdisciplinary Perspectives on Fair-ML" href="../interdisciplinary/introduction.html" />
    <link rel="prev" title="Constrained Learning Algorithms" href="constrainedlearning.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">An Introduction to Responsible Machine Learning</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    An Introduction to Responsible Machine Learning
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../introduction/introduction.html">
   Responsible Machine Learning
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../introduction/machinelearning/introduction.html">
   Machine Learning Preliminaries
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../introduction/machinelearning/modelevaluation.html">
     Model Evaluation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../introduction/machinelearning/modelselection.html">
     Model Selection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../introduction/machinelearning/costsensitivelearning.html">
     Cost-Sensitive Learning
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Fairness
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../introduction.html">
   Algorithmic Fairness
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../groupfairnessmetrics.html">
   Group Fairness Metrics
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="introduction.html">
   Fairness-Aware Machine Learning
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="preprocessing.html">
     Pre-processing Algorithms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="constrainedlearning.html">
     Constrained Learning Algorithms
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Post-processing Algorithms
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../interdisciplinary/introduction.html">
   Interdisciplinary Perspectives on Fair-ML
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../interdisciplinary/philosophy.html">
     Philosophy: What is “Fair”?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../interdisciplinary/law.html">
     Law: Fairness and Discrimination
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../interdisciplinary/sts.html">
     Science and Technology Studies: Abstraction Traps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../tutorials/introduction.html">
   Tutorials
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/measuringgroupfairness.html">
     Measuring Group Fairness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../tutorials/fairnessawareclassification.html">
     Fairness-Aware Classification
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Misc
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../misc/harms.html">
   List of Harms
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/hildeweerts/responsiblemachinelearning"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/hildeweerts/responsiblemachinelearning/issues/new?title=Issue%20on%20page%20%2Ffairness/fairml/postprocessing.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/fairness/fairml/postprocessing.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reject-option-classification">
   Reject Option Classification
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#randomized-group-specific-decision-thresholds">
   Randomized Group-Specific Decision Thresholds
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#leaf-relabelling">
   Leaf Relabelling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Post-processing Algorithms</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reject-option-classification">
   Reject Option Classification
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#randomized-group-specific-decision-thresholds">
   Randomized Group-Specific Decision Thresholds
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#leaf-relabelling">
   Leaf Relabelling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="post-processing-algorithms">
<span id="fairml-post-processing"></span><h1>Post-processing Algorithms<a class="headerlink" href="#post-processing-algorithms" title="Permalink to this headline">#</a></h1>
<p>Post-processing approaches adjust an existing model, either through post-processing predictions or by adjusting the learned model parameters directly. In this section, we will discuss three approaches: reject option classification, (randomized) group-specific decision thresholds, and leaf relabelling.</p>
<section id="reject-option-classification">
<span id="id1"></span><h2>Reject Option Classification<a class="headerlink" href="#reject-option-classification" title="Permalink to this headline">#</a></h2>
<p>Reject option classification is a technique traditionally applied in algorithmic decision-making, where instances for which the predicted class is uncertain are not automatically classified but processed via a different process <a class="footnote-reference brackets" href="#footcite-bartlett2008classification" id="id2">1</a>. For instance, rejected instances may be inspected by a human domain expert. Kamiran <em>et al.</em><a class="footnote-reference brackets" href="#footcite-kamiran2012decision" id="id3">2</a> leverage the principle of reject option classification in the context of fairness. Specifically, the authors assume that more ambiguous instances are most likely to be influenced by biases. Following this assumption, instances for which the classifier is uncertain (i.e., instances close to the decision boundary) are reclassified to promote demographic parity, while maintaining a reasonable level of accuracy.</p>
<p>The reject option classification technique re-classifies instances that fall within what the authors refer to as the <em>critical region</em>: <span class="math notranslate nohighlight">\(max(P(\hat{Y}=1 \mid x), 1 - P(\hat{Y}=1 \mid x) \leq \theta)\)</span> (<a class="reference internal" href="#criticalregion"><span class="std std-numref">Fig. 7</span></a>).</p>
<figure class="align-center" id="criticalregion">
<a class="reference external image-reference" href="none"><img alt="../../_images/criticalregion.svg" src="../../_images/criticalregion.svg" width="300px" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7 </span><span class="caption-text">Reject option classification classifies instances that fall within the critical region with an alternative decision rule, such that the selection rate increases for members of the sensitive group with a low base rate (<span class="math notranslate nohighlight">\(x(A)=a\)</span>) and decreases for memebers of the sensitive group with a high base rate (<span class="math notranslate nohighlight">\(x(A)=a'\)</span>).</span><a class="headerlink" href="#criticalregion" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Parameter <span class="math notranslate nohighlight">\(\theta\)</span> controls the size of the critical region and can take values <span class="math notranslate nohighlight">\(0.5 &lt; \theta &lt; 1\)</span>. Instances within the critical region that belong to a sensitive group with a low base rate are classified as positive, while instances within the critical region that belong to a group with a high base rate are classified as negative. Instances outside the critical region are classified according to the standard decision rule for classification that assigns each instance the most likely class.</p>
<p>The standard decision rule, in which each instance is classified according to the most likely class, minimizes the expected loss of classification. Reject option classification diverts from this decision rule by reclassifying instances in the critical region, which generally will increase the expected loss.</p>
<p>Parameter <span class="math notranslate nohighlight">\(\theta\)</span> controls the trade-off between accuracy and demographic parity difference: increasing <span class="math notranslate nohighlight">\(\theta\)</span> will generally decrease the demographic parity difference as well as the accuracy of the classifier. The value of <span class="math notranslate nohighlight">\(\theta\)</span> can be determined based on a validation dataset or as input by a domain expert.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Reject option classification can be interpreted as a cost-based prediction method in which the cost of misclassifying an instance that belongs to a sensitive group affected by historical bias as negative is <span class="math notranslate nohighlight">\(\theta/(1−\theta)\)</span> times that of misclassifying it as positive.</p>
</div>
<p>The reject option classification decision rules can be described as follows.</p>
<div class="admonition-reject-option-classification admonition">
<p class="admonition-title">Reject option classification</p>
<p>Kamiran <em>et al.</em><a class="footnote-reference brackets" href="#footcite-kamiran2012decision" id="id4">2</a> restrict their approach to a binary classification problem with target variable <span class="math notranslate nohighlight">\(Y\)</span>, where a positive prediction (<span class="math notranslate nohighlight">\(\hat{Y}=1\)</span>) corresponds to the desirable output for data subjects, i.e., receiving a benefit or avoiding a burden.</p>
<p>Let <span class="math notranslate nohighlight">\(A=a\)</span> be the group with a low base rate and <span class="math notranslate nohighlight">\(A=a'\)</span> be the group with a high base rate (i.e., <span class="math notranslate nohighlight">\(P(Y=1 \mid A = a) &lt; P(Y=1 \mid A = a')\)</span>).</p>
<p>At prediction time, the input of the algorithm is sensitive group membership <span class="math notranslate nohighlight">\(x(A)\)</span>, predicted score <span class="math notranslate nohighlight">\(x(R) = P(\hat{Y}=1 \mid x)\)</span>, and parameter <span class="math notranslate nohighlight">\(\theta\)</span>. An instance is classified as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\hat{Y} =
\begin{cases}
0, &amp; \text{if} x(R) &lt; 1 - \theta \\
0, &amp; \text{if} (x(A)=a') \wedge (\max(r(X), 1 - R(x)) \leq \theta) \\
1, &amp; \text{if} (x(A)=a) \wedge (\max(r(X), 1 - R(x)) \leq \theta) \\
1, &amp; \text{if} x(R) &gt; \theta
\end{cases}
\end{split}\]</div>
</div>
<p>Let’s consider the toy dataset displayed in <a class="reference internal" href="#toydatasetroc"><span class="std std-numref">Table 5</span></a>.</p>
<table class="colwidths-auto table" id="toydatasetroc">
<caption><span class="caption-number">Table 5 </span><span class="caption-text">Toy dataset to exemplify the reject option classification technique. <span class="math notranslate nohighlight">\(x(R) = P(Y=1 \mid x)\)</span> represents the confidence score assigned by machine learning model.</span><a class="headerlink" href="#toydatasetroc" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Nationality</p></th>
<th class="head"><p>Highest Degree</p></th>
<th class="head"><p>Job Type</p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(Y\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(x(R)\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>citizen</p></td>
<td><p>university</p></td>
<td><p>board</p></td>
<td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>.99</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>citizen</p></td>
<td><p>high school</p></td>
<td><p>board</p></td>
<td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>.90</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>citizen</p></td>
<td><p>university</p></td>
<td><p>education</p></td>
<td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>.92</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>noncitizen</p></td>
<td><p>university</p></td>
<td><p>healthcare</p></td>
<td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>.72</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>noncitizen</p></td>
<td><p>none</p></td>
<td><p>healthcare</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>.44</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>noncitizen</p></td>
<td><p>high school</p></td>
<td><p>board</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>.09</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>citizen</p></td>
<td><p>university</p></td>
<td><p>education</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>.66</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>citizen</p></td>
<td><p>none</p></td>
<td><p>healthcare</p></td>
<td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>.66</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>noncitizen</p></td>
<td><p>high school</p></td>
<td><p>education</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>.32</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>citizen</p></td>
<td><p>university</p></td>
<td><p>board</p></td>
<td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>.92</p></td>
</tr>
</tbody>
</table>
<p>Assuming <code class="docutils literal notranslate"><span class="pre">nationality</span></code> is considered a sensitive feature, a the default decision threshold is 0.5, a positive prediction (i.e., <span class="math notranslate nohighlight">\(\hat{Y}=1\)</span>) corresponds to a benefit, we can determine which instances would be re-classified with <span class="math notranslate nohighlight">\(\theta=0.7\)</span> as follows.</p>
<p>First, we need to determine which group has a low base rate and which one has a high base rate. <span class="math notranslate nohighlight">\(P(Y=1 \mid A=citizen) = 5/6\)</span> while <span class="math notranslate nohighlight">\(P(Y=1 \mid A=noncitizen) = 1/4\)</span>.</p>
<p>Now, with <span class="math notranslate nohighlight">\(\theta=0.7\)</span>, we know that all instances with <span class="math notranslate nohighlight">\(x(R)\)</span> between 0.3 and 0.7 fall within the critical region and will therefore be reclassified to promote demographic parity. In the toy dataset, instances 5, 7, 8, and 9 fall within the critical region. Instances that do not fall within the critical region (1, 2, 3, 4, 6, and 10) are classified as usual.</p>
<p>In the toy dataset, this implies the following classifications:</p>
<ul class="simple">
<li><p>Instance 6 has <span class="math notranslate nohighlight">\(x(R) &lt; 0.3\)</span> and will be classified as <span class="math notranslate nohighlight">\(\hat{Y} = 0\)</span> .</p></li>
<li><p>Instances 7 and 8 are members of the sensitive group with a high base rate (<code class="docutils literal notranslate"><span class="pre">nationality=citizen</span></code>) and will therefore be classified as <span class="math notranslate nohighlight">\(\hat{Y}=0\)</span>.</p></li>
<li><p>Instances 5 and 9 are members of the sensitive group with a low base rate (<code class="docutils literal notranslate"><span class="pre">nationality=noncitizen</span></code>) and will therefore be classified as <span class="math notranslate nohighlight">\(\hat{Y}=1\)</span>.</p></li>
<li><p>Instances 1, 2, 3, 4, and 10 have <span class="math notranslate nohighlight">\(x(R) &gt; 0.7\)</span> and will be classified as <span class="math notranslate nohighlight">\(\hat{Y} = 1\)</span>.</p></li>
</ul>
<p>If we had used the default decision rule with a decision threshold of 0.5, the selection rates would have been <span class="math notranslate nohighlight">\(P(\hat{Y}=1 \mid A=citizen)=6/6\)</span> and <span class="math notranslate nohighlight">\(P(\hat{Y}=1 \mid A=noncitizen)=1/4\)</span>. The selection rates after reject option classification are <span class="math notranslate nohighlight">\(P(\hat{Y}=1 \mid A=citizen)=4/6\)</span> and <span class="math notranslate nohighlight">\(P(\hat{Y}=1 \mid A=noncitizen)=3/4\)</span>.</p>
</section>
<section id="randomized-group-specific-decision-thresholds">
<span id="randomized-thresholds"></span><h2>Randomized Group-Specific Decision Thresholds<a class="headerlink" href="#randomized-group-specific-decision-thresholds" title="Permalink to this headline">#</a></h2>
<p>If base rates differ across groups, it will often not be possible to identify one unique decision threshold <span class="math notranslate nohighlight">\(t\)</span> such that a fairness constraint holds across all groups. In that case, Hardt <em>et al.</em><a class="footnote-reference brackets" href="#footcite-hardt2016equality" id="id5">3</a> propose to choose separate thresholds <span class="math notranslate nohighlight">\(t_a\)</span> for sensitive groups <span class="math notranslate nohighlight">\(a \in A\)</span>. For example, in order to satisfy <a class="reference internal" href="../groupfairnessmetrics.html#demographic-parity"><span class="std std-ref">demographic parity</span></a>, we could decrease the decision threshold for a group with a low selection rate, such that more instances are classified as positive. Similarly, considering <a class="reference internal" href="../groupfairnessmetrics.html#equalized-odds"><span class="std std-ref">equalized odds</span></a>, increasing or decreasing a group-specific decision threshold allows us to control the trade-off between false positives and false negatives for each sensitive group separately.</p>
<p>Group-specific thresholds are not always sufficient to achieve equalized odds. The trade-off between false positives and false negatives is often analyzed using a <a class="reference internal" href="../../introduction/machinelearning/modelevaluation.html#roc-curve"><span class="std std-ref">Receiver Operating Characteristic (ROC) curve</span></a>, which sets out a classifier’s false positive rate against its true positive rate over varying decision thresholds. Considering equalized odds, group-specific thresholds limit us to the combinations of error rates that lie on the <em>intersection</em> of the group-specific ROC curves.</p>
<p>In some cases, the group-specific ROC curves may not intersect or represent a poor trade-off between false positives and false negatives. To further increase the solution space, Hardt <em>et al.</em><a class="footnote-reference brackets" href="#footcite-hardt2016equality" id="id6">3</a> allow the decision thresholds to be randomized. That is, the decision threshold <span class="math notranslate nohighlight">\(T_a\)</span> is a randomized mixture of two decision thresholds <span class="math notranslate nohighlight">\(\underline{t}_{a}\)</span> and <span class="math notranslate nohighlight">\(\overline{t}_{a}\)</span> (<a class="reference internal" href="#randomizedthresholds"><span class="std std-numref">Fig. 8</span></a>).</p>
<figure class="align-center" id="randomizedthresholds">
<a class="reference external image-reference" href="none"><img alt="../../_images/randomizedthresholds.svg" src="../../_images/randomizedthresholds.svg" width="300px" /></a>
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">A randomized decision threshold is a randomized mixture of two decision thresholds: a random choice between two decision thresholds <span class="math notranslate nohighlight">\(\underline{t}_{a}\)</span> and <span class="math notranslate nohighlight">\(\overline{t}_{a}\)</span> with probability <span class="math notranslate nohighlight">\(p\)</span>.</span><a class="headerlink" href="#randomizedthresholds" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Randomization allows us to achieve <em>any</em> combination of error rates that lies within the convex hull of the ROC curve. In cases where group-specific ROC curves do not intersect apart from trivial end points, the predictive performance of the model for the best-off group can be artificially lowered through randomization until the performance is equal to that of the worst-off group (<a class="reference internal" href="#randomizedthresholdsroc"><span class="std std-numref">Fig. 9</span></a>).</p>
<figure class="align-center" id="randomizedthresholdsroc">
<a class="reference external image-reference" href="none"><img alt="../../_images/randomizedthresholdsroc.svg" src="../../_images/randomizedthresholdsroc.svg" width="300px" /></a>
<figcaption>
<p><span class="caption-number">Fig. 9 </span><span class="caption-text">Randomization of the decision threshold between values <span class="math notranslate nohighlight">\(\underline{t}_{a}\)</span> and <span class="math notranslate nohighlight">\(\overline{t}_{a}\)</span> allows us to achieve any (<span class="math notranslate nohighlight">\(fpr\)</span>, <span class="math notranslate nohighlight">\(tpr\)</span>) combination on the line segment between the corresponding points on the ROC curve. The exact coordinate is determined by <span class="math notranslate nohighlight">\(p_a\)</span>, where higher values of <span class="math notranslate nohighlight">\(p_a\)</span> are closer to <span class="math notranslate nohighlight">\(\overline{t}_{a}\)</span> and vice versa. In this case, the group-specific ROC curves do not intersect, so we cannot find non-randomized group-specific decision thresholds such that equalized odds is satisfied. Randomizing the decision threshold for Group 1 increases the solution space such that equalized odds can be achieved.</span><a class="headerlink" href="#randomizedthresholdsroc" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>In cases where the ROC curves do intersect, but at a sub-optimal point, randomization allows us to achieve a more favorable point on the ROC curve. Note that the maximum true positive rate and true negative rate are always limited by the model’s performance for the sensitive group for which the model performs the worst.</p>
</section>
<section id="leaf-relabelling">
<span id="leaf-relabeling"></span><h2>Leaf Relabelling<a class="headerlink" href="#leaf-relabelling" title="Permalink to this headline">#</a></h2>
<p>In addition to post-processing of predictions, some fairness-aware machine learning algorithms directly adjust the parameters of a trained model to enforce a fairness constraint. One of the earliest of these approaches is the leaf relabelling algorithm for decision trees introduced by Kamiran <em>et al.</em><a class="footnote-reference brackets" href="#footcite-kamiran2010discrimination" id="id7">4</a>.</p>
<p>The default decision rule of a decision tree classifies new instances based on the majority class of the training instances that reside in each leaf. When base rates are unequal in the training data, a decision tree will likely reproduce this disparity. To ensure selection rates are equal, we can control the group-specific selection rates by relabeling one or more leaves of the decision tree. Relabeling a leaf from negative to positive increases the selection rate of a sensitive group whose members end up in that leaf relatively often. Vice versa, relabeling a leaf from positive to negative decreases the selection rate of a highly represented sensitive group.</p>
<p>The leaf relabeling algorithm is designed to swap the predicted class of leaves in the decision tree to satisfy a demographic parity difference constraint while maintaining accuracy as much as possible. The algorithm greedily relabels leaves with the largest decrease in demographic parity difference and the lowest decrease in accuracy, until the demographic parity difference is smaller than a predetermined threshold <span class="math notranslate nohighlight">\(\epsilon\)</span>.</p>
<div class="admonition-leaf-relabeling admonition">
<p class="admonition-title">Leaf Relabeling</p>
<p>The leaf relabeling algorithm changes the predicted class of selected leaves to satisfy a demographic parity difference constraint while maintaining accuracy as much as possible.</p>
<p>The algorithm takes as input decision tree <span class="math notranslate nohighlight">\(T\)</span>.</p>
<ol class="simple">
<li><p><em>Compute the influence of relabeling.</em> For each leaf in the tree <span class="math notranslate nohighlight">\(l \in T\)</span></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Delta acc_l\)</span> : change in accuracy if leaf <span class="math notranslate nohighlight">\(l\)</span> is relabeled.</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta dpd_l\)</span> : change in demographic parity difference if leaf <span class="math notranslate nohighlight">\(l\)</span> is relabeled.</p></li>
</ul>
</li>
<li><p><em>Greedy relabeling.</em></p>
<ul class="simple">
<li><p>Leaves to relabel: <span class="math notranslate nohighlight">\(L = \{ \}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(dpd_T\)</span> : the demographic parity difference of the decision tree.</p></li>
<li><p>Candidate leaves <span class="math notranslate nohighlight">\(I = \{ l \in L \mid \Delta dpd_l &lt; 0\}\)</span>.</p></li>
<li><p>While <span class="math notranslate nohighlight">\(dpd_T &gt; \epsilon\)</span>:</p>
<ul>
<li><p>Identify the best remaining leaf for relabeling: <span class="math notranslate nohighlight">\(\underset{{i \in I \setminus L} }{\operatorname{argmax}} (\Delta dpd_l / \Delta acc_l)\)</span></p></li>
<li><p>Update <span class="math notranslate nohighlight">\(L = L \cup \{l\}\)</span></p></li>
<li><p>Update <span class="math notranslate nohighlight">\(dpd_T\)</span></p></li>
</ul>
</li>
</ul>
</li>
</ol>
</div>
<p>Let’s look at an example. Consider the decision tree in <a class="reference internal" href="#leafrelabeling"><span class="std std-numref">Fig. 10</span></a>. The majority of training instances in leaf <span class="math notranslate nohighlight">\(l_3\)</span> are negatives (2 out of 3). The default decision rule for decision trees would thus classify new instances that fall in leaf <span class="math notranslate nohighlight">\(l_3\)</span> as negative. What would be the effect of changing the label of leaf <span class="math notranslate nohighlight">\(l_3\)</span> from negative to positive?</p>
<figure class="align-center" id="leafrelabeling">
<a class="reference external image-reference" href="none"><img alt="../../_images/leafrelabeling.svg" src="../../_images/leafrelabeling.svg" width="400px" /></a>
<figcaption>
<p><span class="caption-number">Fig. 10 </span><span class="caption-text">A decision tree trained on a data set containing two categorical features, feature 1 and feature 2. Each rectangle represents a leaf of the decision tree. Each dot represents an instance in the training data set. The default decision rule of a decision tree classifies new instances based on the majority class of the training instances that reside in each leaf.</span><a class="headerlink" href="#leafrelabeling" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>First, we consider the change in accuracy. We have 20 instances. With the original label, leaf <span class="math notranslate nohighlight">\(l_3\)</span> classifies 2 instances correctly as negative and 1 instance incorrectly as negative. If we were to change the label from negative to positive, we classify 2 negative instances incorrectly as positive and 1 positive instance correctly. The difference in accuracy between the original tree and a tree where leaf <span class="math notranslate nohighlight">\(l_3\)</span> is relabeled is therefore: <span class="math notranslate nohighlight">\(\Delta acc_l = (1 - 2)/20 = -1/20\)</span>.</p>
<p>Second, consider the change in demographic parity difference. Each sensitive group has 10 instances. After relabeling, 1 instance of group 0 will be classified as positive, rather than negative, increasing the selection rate by 1/10. At the same time, 2 instances of group 1 are reclassified from negative to positive, increasing the selection rate by 2/10. The change in demographic parity difference is,therefore, <span class="math notranslate nohighlight">\(\Delta dpd_l = 1/10 - 2/10 = -1/10\)</span>.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<div class="docutils container" id="id8">
<dl class="footnote brackets">
<dt class="label" id="footcite-bartlett2008classification"><span class="brackets"><a class="fn-backref" href="#id2">1</a></span></dt>
<dd><p>Peter L Bartlett and Marten H Wegkamp. Classification with a reject option using a hinge loss. <em>Journal of Machine Learning Research</em>, 2008.</p>
</dd>
<dt class="label" id="footcite-kamiran2012decision"><span class="brackets">2</span><span class="fn-backref">(<a href="#id3">1</a>,<a href="#id4">2</a>)</span></dt>
<dd><p>Faisal Kamiran, Asim Karim, and Xiangliang Zhang. Decision theory for discrimination-aware classification. In <em>2012 IEEE 12th international conference on data mining</em>, 924–929. IEEE, 2012.</p>
</dd>
<dt class="label" id="footcite-hardt2016equality"><span class="brackets">3</span><span class="fn-backref">(<a href="#id5">1</a>,<a href="#id6">2</a>)</span></dt>
<dd><p>Moritz Hardt, Eric Price, and Nati Srebro. Equality of opportunity in supervised learning. <em>Advances in neural information processing systems</em>, 2016.</p>
</dd>
<dt class="label" id="footcite-kamiran2010discrimination"><span class="brackets"><a class="fn-backref" href="#id7">4</a></span></dt>
<dd><p>Faisal Kamiran, Toon Calders, and Mykola Pechenizkiy. Discrimination aware decision tree learning. In <em>2010 IEEE international conference on data mining</em>, 869–874. IEEE, 2010.</p>
</dd>
</dl>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./fairness/fairml"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="constrainedlearning.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Constrained Learning Algorithms</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../interdisciplinary/introduction.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Interdisciplinary Perspectives on Fair-ML</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Hilde Weerts<br/>
  
      &copy; Copyright 2024.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>